{% extends "admin/base.html" %}
{% load static %}

{% block title %}{% if offer %}Edit{% else %}Add{% endif %} Promotional Offer - Admin{% endblock %}

{% block content %}
<div class="container">
  <div class="page-inner">
    <div class="page-header">
      <h3 class="fw-bold mb-3">üéÅ {% if offer %}Edit{% else %}Add{% endif %} Promotional Offer</h3>
      <p class="text-muted">Create special offers and discounts for your customers</p>
    </div>

    <div class="row">
      <div class="col-md-8">
        <div class="card">
          <div class="card-header">
            <h4 class="card-title">Offer Details</h4>
          </div>
          <div class="card-body">
            <form method="post" enctype="multipart/form-data">
              {% csrf_token %}
              
              <div class="form-group">
                <label for="title">Offer Title *</label>
                <input type="text" class="form-control" id="title" name="title" value="{{ offer.title }}" required placeholder="e.g., 20% Off on Wedding Cakes">
                <small class="form-text text-muted">Short, catchy offer title</small>
              </div>

              <div class="form-group">
                <label for="description">Description *</label>
                <textarea class="form-control" id="description" name="description" rows="4" required placeholder="Offer details, terms, and conditions...">{{ offer.description }}</textarea>
                <small class="form-text text-muted">Full offer details and terms</small>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="discount_percentage">Discount Percentage</label>
                    <div class="input-group">
                      <input type="number" step="0.01" class="form-control" id="discount_percentage" name="discount_percentage" value="{{ offer.discount_percentage }}" placeholder="e.g., 10, 20, 25" min="0" max="100">
                      <div class="input-group-append">
                        <span class="input-group-text">%</span>
                      </div>
                    </div>
                    <small class="form-text text-muted">Leave blank if not applicable</small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="image">Offer Banner Image *</label>
                    <input type="file" class="form-control" id="image" name="image" accept="image/*" {% if not offer %}required{% endif %}>
                    <small class="form-text text-muted"><strong>Size: 800√ó400 pixels</strong></small>
                  </div>
                </div>
              </div>

              {% if offer and offer.image %}
              <div class="form-group">
                <label>Current Image</label>
                <div>
                  <img src="{{ offer.image.url }}" style="max-width: 100%; max-height: 200px; object-fit: cover;" class="img-thumbnail">
                </div>
              </div>
              {% endif %}

              <hr class="my-3">

              <h5 class="mb-3"><i class="fas fa-calendar-alt"></i> Validity Period</h5>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="start_date">Start Date *</label>
                    <input type="date" class="form-control" id="start_date" name="start_date" value="{% if offer %}{{ offer.start_date|date:'Y-m-d' }}{% else %}{{ today|date:'Y-m-d' }}{% endif %}" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="end_date">End Date *</label>
                    <input type="date" class="form-control" id="end_date" name="end_date" value="{% if offer %}{{ offer.end_date|date:'Y-m-d' }}{% endif %}" required>
                  </div>
                </div>
              </div>

              <div class="form-check mb-3">
                <input class="form-check-input" type="checkbox" name="is_active" id="is_active" {% if not offer or offer.is_active %}checked{% endif %}>
                <label class="form-check-label" for="is_active">
                  <strong>Active</strong>
                </label>
              </div>

              <div class="mt-4">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i> Save Offer
                </button>
                <a href="{% url 'admin_offers' %}" class="btn btn-secondary">Cancel</a>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Help Section -->
      <div class="col-md-4">
        <div class="card">
          <div class="card-header">
            <h4 class="card-title"><i class="fas fa-question-circle"></i> Help</h4>
          </div>
          <div class="card-body">
            <h6><i class="fas fa-lightbulb"></i> Offer Examples:</h6>
            <ul style="font-size: 14px;">
              <li>20% Off on Birthday Cakes</li>
              <li>Buy 2 Get 1 Free</li>
              <li>Weekend Special - 15% Discount</li>
              <li>First Order Discount</li>
            </ul>

            <hr>

            <h6><i class="fas fa-image"></i> Image Guidelines:</h6>
            <ul class="text-muted" style="font-size: 14px;">
              <li><strong>Size:</strong> 800√ó400 pixels</li>
              <li><strong>Format:</strong> JPG or PNG</li>
              <li><strong>Content:</strong> Eye-catching banner</li>
            </ul>

            <hr>

            <h6><i class="fas fa-calendar"></i> Validity:</h6>
            <p class="text-muted" style="font-size: 14px;">
              Set start and end dates to automatically activate/deactivate the offer.
            </p>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
